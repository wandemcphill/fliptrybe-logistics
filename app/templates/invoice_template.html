{% extends "base.html" %}

{% block content %}
<div class="bg-gray-50 min-h-screen py-12 px-6 print:bg-white print:p-0">
    
    <div class="max-w-3xl mx-auto mb-8 flex justify-between items-center print:hidden">
        <a href="{{ url_for('main.dashboard') }}" class="text-[10px] font-bold uppercase tracking-widest text-gray-400 hover:text-black transition-colors">
            <i class="fas fa-arrow-left mr-1"></i> Return to Dashboard
        </a>
        <button onclick="window.print()" class="bg-black text-white px-6 py-3 rounded-xl text-[9px] font-black uppercase tracking-widest hover:bg-gray-800 transition-all shadow-lg flex items-center gap-2">
            <i class="fas fa-print"></i> Print / Save PDF
        </button>
    </div>

    <div class="max-w-3xl mx-auto bg-white p-12 rounded-[40px] shadow-sm border border-gray-100 print:shadow-none print:border-none print:rounded-none print:w-full print:max-w-none">
        
        <div class="flex justify-between items-start mb-12 border-b-2 border-black pb-8">
            <div>
                <h1 class="text-4xl font-black uppercase italic tracking-tighter mb-2">FlipTrybe <span class="text-blue-600">Grid</span></h1>
                <p class="text-[9px] font-bold text-gray-400 uppercase tracking-widest">
                    Official Transaction Receipt
                </p>
            </div>
            <div class="text-right">
                <p class="text-[10px] font-black uppercase text-gray-900 mb-1">Invoice #{{ order.id|string|zfill(6) }}</p>
                <p class="text-[10px] font-bold uppercase text-gray-400">Date: {{ order.timestamp.strftime('%d %b, %Y') }}</p>
                <p class="text-[10px] font-bold uppercase text-gray-400">Ref: {{ order.handshake_id }}</p>
            </div>
        </div>

        <div class="grid grid-cols-2 gap-12 mb-12">
            <div>
                <p class="text-[9px] font-black uppercase tracking-widest text-gray-400 mb-4 border-b border-gray-100 pb-2">Merchant Node</p>
                <h4 class="text-sm font-black uppercase text-gray-900">{{ order.listing.author.name }}</h4>
                <p class="text-[10px] text-gray-500 uppercase">{{ order.listing.author.email }}</p>
                <p class="text-[10px] text-gray-500 uppercase mt-1">{{ order.listing.state }}</p>
            </div>

            <div class="text-right">
                <p class="text-[9px] font-black uppercase tracking-widest text-gray-400 mb-4 border-b border-gray-100 pb-2">Billed To</p>
                <h4 class="text-sm font-black uppercase text-gray-900">{{ order.buyer.name }}</h4>
                <p class="text-[10px] text-gray-500 uppercase">{{ order.buyer.email }}</p>
                <p class="text-[10px] text-gray-500 uppercase mt-1">FlipTrybe Verified ID</p>
            </div>
        </div>

        <div class="mb-12">
            <table class="w-full text-left">
                <thead>
                    <tr class="border-b border-gray-200">
                        <th class="pb-4 text-[9px] font-black text-gray-400 uppercase tracking-widest w-1/2">Asset Description</th>
                        <th class="pb-4 text-[9px] font-black text-gray-400 uppercase tracking-widest text-center">Qty</th>
                        <th class="pb-4 text-[9px] font-black text-gray-400 uppercase tracking-widest text-right">Unit Price</th>
                        <th class="pb-4 text-[9px] font-black text-gray-400 uppercase tracking-widest text-right">Total</th>
                    </tr>
                </thead>
                <tbody class="divide-y divide-gray-50">
                    <tr>
                        <td class="py-6">
                            <p class="text-xs font-black uppercase text-gray-900">{{ order.listing.title }}</p>
                            <p class="text-[9px] text-gray-400 uppercase mt-1">Category: {{ order.listing.category }}</p>
                        </td>
                        <td class="py-6 text-center text-xs font-bold text-gray-900">1</td>
                        <td class="py-6 text-right text-xs font-bold text-gray-900">₦{{ "{:,.2f}".format(order.listing.price) }}</td>
                        <td class="py-6 text-right text-xs font-bold text-gray-900">₦{{ "{:,.2f}".format(order.listing.price) }}</td>
                    </tr>
                    
                    <tr>
                        <td class="py-4">
                            <p class="text-[10px] font-bold uppercase text-gray-500">Escrow Protection Fee</p>
                        </td>
                        <td class="py-4 text-center text-[10px] font-bold text-gray-500">1</td>
                        <td class="py-4 text-right text-[10px] font-bold text-gray-500">₦0.00</td>
                        <td class="py-4 text-right text-[10px] font-bold text-gray-500">₦0.00</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="flex justify-end mb-16">
            <div class="w-1/2 bg-gray-50 p-6 rounded-2xl print:bg-transparent print:border print:border-gray-200">
                <div class="flex justify-between mb-2">
                    <span class="text-[10px] font-bold text-gray-500 uppercase">Subtotal</span>
                    <span class="text-[10px] font-bold text-gray-900">₦{{ "{:,.2f}".format(order.listing.price) }}</span>
                </div>
                <div class="flex justify-between mb-4 pb-4 border-b border-gray-200">
                    <span class="text-[10px] font-bold text-gray-500 uppercase">Service Fee</span>
                    <span class="text-[10px] font-bold text-gray-900">₦0.00</span>
                </div>
                <div class="flex justify-between items-center">
                    <span class="text-xs font-black text-gray-900 uppercase">Total Paid</span>
                    <span class="text-xl font-black text-black">₦{{ "{:,.2f}".format(order.total_price) }}</span>
                </div>
            </div>
        </div>

        <div class="border-t-2 border-gray-100 pt-8 flex flex-col md:flex-row justify-between items-end gap-6">
            <div>
                <p class="text-[8px] font-bold text-gray-400 uppercase tracking-widest mb-2">Terms & Conditions</p>
                <p class="text-[9px] text-gray-500 max-w-xs leading-relaxed">
                    This receipt confirms that funds have been secured in the FlipTrybe Escrow Vault. Payout to merchant is conditional upon successful delivery and buyer confirmation.
                </p>
            </div>
            <div class="text-right">
                <div class="w-24 ml-auto mb-2 opacity-50">
                    <div class="border-b border-black h-8"></div>
                </div>
                <p class="text-[8px] font-black uppercase text-gray-900 tracking-widest">Authorized System Stamp</p>
            </div>
        </div>

    </div>
</div>

<style>
    @media print {
        @page { margin: 0; }
        body { background: white; margin: 0; }
        nav, footer, .print\:hidden { display: none !important; }
        .print\:shadow-none { box-shadow: none !important; }
        .print\:border-none { border: none !important; }
        .print\:bg-white { background: white !important; }
        .print\:p-0 { padding: 0 !important; }
    }
</style>
{% endblock %}